<HTML><HEAD><TITLE>SwissDelphiCenter.ch : ...Drag and Drop files from your application to Windows Explorer?</TITLE></HEAD><META NAME="Title" CONTENT="SwissDelphiCenter.ch">
<META NAME="Author" CONTENT="Simon Grossenbacher"
<META NAME="Publisher" CONTENT="SwissDelphiCenter.ch">
<META NAME="Revisit" CONTENT="After 30 days">
<META NAME="Keywords" 
CONTENT="delphi,borland,programm,programming,schweiz,forum,forums,newsletter,download,delphi,kylix,linux,windows,winapi,libc, api">
<META NAME="Description" CONTENT="All about Borland Delphi. Programming tips, downloads, forums, news, topsites, newsletter">
<META NAME="Abstract" CONTENT="All about Borland Delphi.">
<META NAME="Robots" CONTENT="INDEX,FOLLOW">
<META NAME="expires" CONTENT="0">
<link rel="SHORTCUT ICON" href="http://www.swissdelphicenter.ch/favicon.ico">

<link rel="STYLESHEET" href="../swissdelphicenter.css" type="text/css">
</head>
<body bgcolor="#FFFFFF">
<table width="100%" border="0">
  <tr>
    <td width="33%"><i><a href="index.php"><img src="../pics/sdclogo.png" border="0" width="300" height="40"></a></i></td>
    <td width="67%">
<a href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=136&amp;zoneid=7&amp;source=&amp;dest=http%3A%2F%2Fwww.dbfreemagazine.com.br' target='_blank'><img src='http://www.swissdelphicenter.com/ads/banners/banner_dbfree_english.gif' width='468' height='60' alt='' title='' border='0'></a><div id="beacon_136" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=136&amp;clientid=168&amp;zoneid=7&amp;source=&amp;block=0&amp;capping=0&amp;cb=1c48cbbcbb94d8de2404572b5dee16b8' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br>

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="werbung.php">Advertising on SwissDelphiCenter</a>

</td>
  </tr>
</table>
<br>
&nbsp;<a href="whatsnew.php">whats new</a>&nbsp;&brvbar;&nbsp;
<a href="tipsindex.php">programming tips</a>&nbsp;&brvbar;&nbsp;
<a href="indyarticles.php">indy articles</a>&nbsp;&brvbar;&nbsp;
<a href="iwarticles.php">intraweb articles</a>&nbsp;&brvbar;&nbsp;
<a href="infoindex.php">informations</a>&nbsp;&brvbar;&nbsp;
<a href="linksindex.php">links</a>&nbsp;&brvbar;&nbsp;
<a href="interviews.php">interviews</a>&nbsp;&brvbar;&nbsp;
<a href="sonstigesindex.php">misc</a>&nbsp;&brvbar;&nbsp;
<a href="forum/index.php">forum</a>
<br>
&nbsp;<a href="devnews.php">developer news</a>&nbsp;&brvbar;&nbsp;
<a href="kylix.php">kylix</a>&nbsp;&brvbar;&nbsp;
<a href="tutorials.php">tutorials</a>&nbsp;&brvbar;&nbsp;
<a href="shop.php">online shop</a>&nbsp;&brvbar;&nbsp;
<a href="photos/index.php">photos</a>&nbsp;&brvbar;&nbsp;
<a href="addwin.php">Add&Win Game</a>
<br><br>
<table width="100%" border="0" cellpadding="4" cellspacing="0">
  <tr>
    <td>
    </td>
  </tr>
  <tr> 
    <td>
      <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr> 
          <td width="21%" align="left" valign="top"> 
            <table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
              <tr align="left" valign="top"> 
                <td> 
                  <table width="100%" border="0" cellpadding="10" cellspacing="0">
                    <tr bgcolor="#99CCFF"> 
                      <td>
 
<p><b>Tips (1553)</b></p>

<a href="datenbanken.php">Database (90)</a><br><a href="dateien.php">Files (139)</a><br><a href="oberflaeche.php">Forms (112)</a><br><a href="grafik.php">Graphic (116)</a><br><a href="ide.php">IDE (21)</a><br><a href="indy.php">Indy (5)</a><br><a href="internet.php">Internet / LAN (130)</a><br><a href="intraweb.php">IntraWeb (0)</a><br><a href="kylixtips.php">Kylix (10)</a><br><a href="math.php">Math (77)</a><br><a href="sonstiges.php">Misc (126)</a><br><a href="multimedia.php">Multimedia (46)</a><br><a href="objekte.php">Objects/<br>ActiveX (51)</a><br><a href="opentools.php">OpenTools API (3)</a><br><a href="printing.php">Printing (34)</a><br><a href="strings.php">Strings (83)</a><br><a href="system.php">System (267)</a><br><a href="vcl.php">VCL (243)</a><br>


  <br>
  <a href="tiptop15.php">Top15</a><br><br>
  <a href="tipsbycomp.php">Tips sort by<br>component</a><br><br>
  <a href="tipsuchen.php">Search Tip</a><br><br>

  <a href="addtip.php">Add new Tip</a><br><br>
  <a href="addwin.php"><b>Add&Win Game</b></a>

</td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
            <br>
                    <table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
          <tr align="left" valign="top">
            <td height="3">
              <table width="100%" border="0" cellpadding="10" cellspacing="0" height="100%">
                <tr bgcolor="#FFFFFF" align="left" valign="top"> 
                  <td bgcolor="#99CCFF"><b>BorCon 2003 pictures</b></td>
                </tr>
                <tr bgcolor="#FFFFFF" align="left" valign="top">
                  
          <td>The Borland Conference 2003 has finished. We have taken some impressions for you in the <b><a 
href="http://www.swissdelphicenter.ch/en/photos/index.php">photo gallery</a></b></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
            <br>            
            <table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
              <tr align="left" valign="top"> 
                <td> 
                  <table width="100%" border="0" cellpadding="10" cellspacing="0">
                    <tr bgcolor="#99CCFF" align="left" valign="top"> 
                      <td>
                        <center>
<span class="useronline">108 Visitors Online</span>                        </center>
                        </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
            <br><br>
            <center>
            <a href="http://www.borland.com" target="_blank"><img src="../pics/btp.gif" alt="SwissDelphiCenter is a Borland Technology Partner" border="0"></a>
            </center>
          </td>
          <td width="1%" align="left" valign="top">&nbsp;</td>
          <td align="left" valign="top" width="78%"> 
            <table width="100%" border="0" cellpadding="2" cellspacing="0" height="100%" bgcolor="#0099FF">
              <tr> 
                <td> 
                  <table width="100%" border="0" cellpadding="5" height="100%" bgcolor="#FFFFFF" cellspacing="0">
                    <tr align="left" valign="top"> 
                      <td> 

<table width="100%" border="0">
  <tr> 
    <td>
      <span class="titel">...Drag and Drop files from your application to Windows Explorer?</span>
    </td>
  </tr>
  <tr> 
    <td>Autor: 
      <a href="sendmail.php?id=2335">R.Kleinpeter</a>    </td>
  </tr>
  <tr><td>[<a href="newcomment.php?id=2335">Write new comment</a>]</td></tr><tr><td>[ <a href="printcode.php?id=2335" target="_blank">Print tip</a> 
]</td><td>&nbsp;</td><td>&nbsp;</td></tr></table>
<br>
<table border="0" width="529">
  <tr> 
    <td width="149"><b>Tip Rating (16):</b></td>
    <td width="370">&nbsp;</td>
  </tr>
  <tr>
    <td>
<img src='../pics/progressbar-grau.gif'>&nbsp;<img src='../pics/progressbar-grau.gif'>&nbsp;<img src='../pics/progressbar-grau.gif'>&nbsp;<img src='../pics/progressbar-grau.gif'>&nbsp;<img src='../pics/progressbar-blau.gif'>&nbsp;</td>
  </tr>
</table>

<p><br>
</p>
<p>
<span class="sourcecode">
<font  size=2 face="Courier New" color="#000080"><i>{This&nbsp;example&nbsp;will&nbsp;show&nbsp;you&nbsp;how&nbsp;your&nbsp;application<br />
will&nbsp;be&nbsp;able&nbsp;to&nbsp;copy&nbsp;files&nbsp;from&nbsp;your&nbsp;application&nbsp;to<br />
Windows&nbsp;Explorer&nbsp;using&nbsp;Drag'n&nbsp;Drop.<br />
Exactly&nbsp;the&nbsp;way&nbsp;it&nbsp;is&nbsp;done&nbsp;by&nbsp;the&nbsp;OS&nbsp;itself!<br />
<br />
Create&nbsp;a&nbsp;new&nbsp;application&nbsp;containing&nbsp;just&nbsp;one&nbsp;unit,<br />
called&nbsp;'Unit1'.&nbsp;Drop&nbsp;a&nbsp;FileListBox&nbsp;and&nbsp;a&nbsp;DirectoryListBox&nbsp;on&nbsp;to&nbsp;the&nbsp;form,<br />
leave&nbsp;their&nbsp;names&nbsp;the&nbsp;way&nbsp;they&nbsp;are.<br />
Connect&nbsp;FileListBox1&nbsp;with&nbsp;DirectoryListBox1&nbsp;by&nbsp;setting&nbsp;the&nbsp;FileList-property&nbsp;of<br />
DirectoryListBox1.&nbsp;Make&nbsp;sure&nbsp;that&nbsp;the&nbsp;MultiSelect-property&nbsp;of&nbsp;FileListBox1&nbsp;is&nbsp;set&nbsp;to&nbsp;'True'!<br />
<br />
The&nbsp;best&nbsp;thing&nbsp;you&nbsp;can&nbsp;do&nbsp;now&nbsp;is&nbsp;to&nbsp;replace&nbsp;all&nbsp;text&nbsp;with&nbsp;the&nbsp;code&nbsp;below:}<br />
<br />
//---------------------------------------------<br />
<br />
</i></font><b>unit&nbsp;</b>Unit1;<br />
<br />
<b>interface<br />
<br />
uses<br />
&nbsp;&nbsp;</b>Windows,&nbsp;Messages,&nbsp;SysUtils,&nbsp;Classes,&nbsp;Graphics,&nbsp;Controls,&nbsp;Forms,<br />
&nbsp;&nbsp;Dialogs,<br />
&nbsp;&nbsp;StdCtrls,&nbsp;FileCtrl,&nbsp;ActiveX,&nbsp;ShlObj,&nbsp;ComObj;<br />
<br />
<b>type<br />
&nbsp;&nbsp;</b>TForm1&nbsp;=&nbsp;<b>class</b>(TForm,&nbsp;IDropSource)<br />
&nbsp;&nbsp;&nbsp;&nbsp;FileListBox1:&nbsp;TFileListBox;<br />
&nbsp;&nbsp;&nbsp;&nbsp;DirectoryListBox1:&nbsp;TDirectoryListBox;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>FileListBox1MouseDown(Sender:&nbsp;TObject;&nbsp;Button:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TMouseButton;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shift:&nbsp;TShiftState;&nbsp;X,&nbsp;Y:&nbsp;Integer);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>FileListBox1MouseMove(Sender:&nbsp;TObject;&nbsp;Shift:&nbsp;TShiftState;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y:&nbsp;Integer);<br />
&nbsp;&nbsp;<b>private<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>FDragStartPos:&nbsp;TPoint;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>function&nbsp;</b>QueryContinueDrag(fEscapePressed:&nbsp;BOOL;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grfKeyState:&nbsp;Longint):&nbsp;HResult;&nbsp;<b>stdcall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>function&nbsp;</b>GiveFeedback(dwEffect:&nbsp;Longint):&nbsp;HResult;&nbsp;<b>stdcall</b>;<br />
&nbsp;&nbsp;<b>public<br />
&nbsp;&nbsp;end</b>;<br />
<br />
<b>var<br />
&nbsp;&nbsp;</b>Form1:&nbsp;TForm1;<br />
<br />
<b>implementation<br />
<br />
</b><font color="#000080"><i>{$R&nbsp;*.DFM}<br />
<br />
</i></font><b>function&nbsp;</b>GetFileListDataObject(<b>const&nbsp;</b>Directory:&nbsp;<b>string</b>;&nbsp;Files:<br />
&nbsp;&nbsp;TStrings):<br />
&nbsp;&nbsp;IDataObject;<br />
<b>type<br />
&nbsp;&nbsp;</b>PArrayOfPItemIDList&nbsp;=&nbsp;^TArrayOfPItemIDList;<br />
&nbsp;&nbsp;TArrayOfPItemIDList&nbsp;=&nbsp;<b>array</b>[0..0]&nbsp;<b>of&nbsp;</b>PItemIDList;<br />
<b>var<br />
&nbsp;&nbsp;</b>Malloc:&nbsp;IMalloc;<br />
&nbsp;&nbsp;Root:&nbsp;IShellFolder;<br />
&nbsp;&nbsp;FolderPidl:&nbsp;PItemIDList;<br />
&nbsp;&nbsp;Folder:&nbsp;IShellFolder;<br />
&nbsp;&nbsp;p:&nbsp;PArrayOfPItemIDList;<br />
&nbsp;&nbsp;chEaten:&nbsp;ULONG;<br />
&nbsp;&nbsp;dwAttributes:&nbsp;ULONG;<br />
&nbsp;&nbsp;FileCount:&nbsp;Integer;<br />
&nbsp;&nbsp;i:&nbsp;Integer;<br />
<b>begin<br />
&nbsp;&nbsp;</b>Result&nbsp;:=&nbsp;<b>nil</b>;<br />
&nbsp;&nbsp;<b>if&nbsp;</b>Files.Count&nbsp;=&nbsp;0&nbsp;<b>then<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>Exit;<br />
&nbsp;&nbsp;OleCheck(SHGetMalloc(Malloc));<br />
&nbsp;&nbsp;OleCheck(SHGetDesktopFolder(Root));<br />
&nbsp;&nbsp;OleCheck(Root.ParseDisplayName(0,&nbsp;<b>nil</b>,<br />
&nbsp;&nbsp;&nbsp;&nbsp;PWideChar(WideString(Directory)),<br />
&nbsp;&nbsp;&nbsp;&nbsp;chEaten,&nbsp;FolderPidl,&nbsp;dwAttributes));<br />
&nbsp;&nbsp;<b>try<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>OleCheck(Root.BindToObject(FolderPidl,&nbsp;<b>nil</b>,&nbsp;IShellFolder,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pointer(Folder)));<br />
&nbsp;&nbsp;&nbsp;&nbsp;FileCount&nbsp;:=&nbsp;Files.Count;<br />
&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;AllocMem(SizeOf(PItemIDList)&nbsp;*&nbsp;FileCount);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>try<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</b>i&nbsp;:=&nbsp;0&nbsp;<b>to&nbsp;</b>FileCount&nbsp;-&nbsp;1&nbsp;<b>do<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>OleCheck(Folder.ParseDisplayName(0,&nbsp;<b>nil</b>,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PWideChar(WideString(Files[i])),&nbsp;chEaten,&nbsp;p^[i],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwAttributes));<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OleCheck(Folder.GetUIObjectOf(0,&nbsp;FileCount,&nbsp;p^[0],&nbsp;IDataObject,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>nil</b>,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pointer(Result)));<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>finally<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</b>i&nbsp;:=&nbsp;0&nbsp;<b>to&nbsp;</b>FileCount&nbsp;-&nbsp;1&nbsp;<b>do&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</b>p^[i]&nbsp;&lt;&gt;&nbsp;<b>nil&nbsp;then&nbsp;</b>Malloc.Free(p^[i]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FreeMem(p);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;<b>finally<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>Malloc.Free(FolderPidl);<br />
&nbsp;&nbsp;<b>end</b>;<br />
<b>end</b>;<br />
<br />
<b>function&nbsp;</b>TForm1.QueryContinueDrag(fEscapePressed:&nbsp;BOOL;<br />
&nbsp;&nbsp;grfKeyState:&nbsp;Longint):&nbsp;HResult;&nbsp;<b>stdcall</b>;<br />
<b>begin<br />
&nbsp;&nbsp;if&nbsp;</b>fEscapePressed&nbsp;<b>or&nbsp;</b>(grfKeyState&nbsp;<b>and&nbsp;</b>MK_RBUTTON&nbsp;=&nbsp;MK_RBUTTON)&nbsp;<b>then<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>Result&nbsp;:=&nbsp;DRAGDROP_S_CANCEL<br />
&nbsp;&nbsp;<b>end&nbsp;else&nbsp;if&nbsp;</b>grfKeyState&nbsp;<b>and&nbsp;</b>MK_LBUTTON&nbsp;=&nbsp;0&nbsp;<b>then<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>Result&nbsp;:=&nbsp;DRAGDROP_S_DROP<br />
&nbsp;&nbsp;<b>end&nbsp;else<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>Result&nbsp;:=&nbsp;S_OK;<br />
&nbsp;&nbsp;<b>end</b>;<br />
<b>end</b>;<br />
<br />
<b>function&nbsp;</b>TForm1.GiveFeedback(dwEffect:&nbsp;Longint):&nbsp;HResult;&nbsp;<b>stdcall</b>;<br />
<b>begin<br />
&nbsp;&nbsp;</b>Result&nbsp;:=&nbsp;DRAGDROP_S_USEDEFAULTCURSORS;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TForm1.FileListBox1MouseDown(Sender:&nbsp;TObject;<br />
&nbsp;&nbsp;Button:&nbsp;TMouseButton;&nbsp;Shift:&nbsp;TShiftState;&nbsp;X,&nbsp;Y:&nbsp;Integer);<br />
<b>begin<br />
&nbsp;&nbsp;if&nbsp;</b>Button&nbsp;=&nbsp;mbLeft&nbsp;<b>then<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>FDragStartPos.x&nbsp;:=&nbsp;X;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FDragStartPos.y&nbsp;:=&nbsp;Y;<br />
&nbsp;&nbsp;<b>end</b>;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TForm1.FileListBox1MouseMove(Sender:&nbsp;TObject;&nbsp;Shift:<br />
&nbsp;&nbsp;TShiftState;<br />
&nbsp;&nbsp;X,&nbsp;Y:&nbsp;Integer);<br />
<b>const<br />
&nbsp;&nbsp;</b>Threshold&nbsp;=&nbsp;5;<br />
<b>var<br />
&nbsp;&nbsp;</b>SelFileList:&nbsp;TStrings;<br />
&nbsp;&nbsp;i:&nbsp;Integer;<br />
&nbsp;&nbsp;DataObject:&nbsp;IDataObject;<br />
&nbsp;&nbsp;Effect:&nbsp;DWORD;<br />
<b>begin<br />
&nbsp;&nbsp;with&nbsp;</b>Sender&nbsp;<b>as&nbsp;</b>TFileListBox&nbsp;<b>do<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</b>(SelCount&nbsp;&gt;&nbsp;0)&nbsp;<b>and&nbsp;</b>(csLButtonDown&nbsp;<b>in&nbsp;</b>ControlState)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>and&nbsp;</b>((Abs(X&nbsp;-&nbsp;FDragStartPos.x)&nbsp;&gt;=&nbsp;Threshold)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>or&nbsp;</b>(Abs(Y&nbsp;-&nbsp;FDragStartPos.y)&nbsp;&gt;=&nbsp;Threshold))&nbsp;<b>then<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>Perform(WM_LBUTTONUP,&nbsp;0,&nbsp;MakeLong(X,&nbsp;Y));<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SelFileList&nbsp;:=&nbsp;TStringList.Create;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>try<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>SelFileList.Capacity&nbsp;:=&nbsp;SelCount;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>for&nbsp;</b>i&nbsp;:=&nbsp;0&nbsp;<b>to&nbsp;</b>Items.Count&nbsp;-&nbsp;1&nbsp;<b>do<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</b>Selected[i]&nbsp;<b>then&nbsp;</b>SelFileList.Add(Items[i]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataObject&nbsp;:=&nbsp;GetFileListDataObject(Directory,&nbsp;SelFileList);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>finally<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>SelFileList.Free;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Effect&nbsp;:=&nbsp;DROPEFFECT_NONE;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DoDragDrop(DataObject,&nbsp;Self,&nbsp;DROPEFFECT_COPY,&nbsp;Effect);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;<b>end</b>;<br />
<b>end</b>;<br />
<br />
<b>initialization<br />
&nbsp;&nbsp;</b>OleInitialize(<b>nil</b>);<br />
<b>finalization<br />
&nbsp;&nbsp;</b>OleUninitialize;<br />
<b>end</b>.<br />
<br />
-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-<br />
<font color="#000080"><i>{<br />
As&nbsp;you&nbsp;might&nbsp;have&nbsp;seen,&nbsp;TForm1&nbsp;is&nbsp;not&nbsp;only&nbsp;a&nbsp;member&nbsp;of&nbsp;class&nbsp;TForm,<br />
but&nbsp;also&nbsp;of&nbsp;class&nbsp;IDropSource!<br />
<br />
Now&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;two&nbsp;FileListBox&nbsp;events<br />
'OnMouseMove'&nbsp;and&nbsp;'OnMouseDown'&nbsp;are&nbsp;set&nbsp;correctly.<br />
<br />
Run&nbsp;your&nbsp;application&nbsp;and&nbsp;try&nbsp;out&nbsp;the&nbsp;Drag&nbsp;and&nbsp;Drop&nbsp;feature!<br />
You&nbsp;can&nbsp;select&nbsp;multiple&nbsp;items&nbsp;to&nbsp;drag&nbsp;and&nbsp;press&nbsp;escape&nbsp;to&nbsp;cancel.<br />
The&nbsp;cursor&nbsp;will&nbsp;show&nbsp;you&nbsp;what&nbsp;action&nbsp;will&nbsp;take&nbsp;place.<br />
}<br />
<br />
</i></font></font><br />
</span>
<br>
</p>
<p>&nbsp;</p>
<table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
  <tr align="left" valign="top"> 
    <td height="3"> 
      <table width="100%" border="0" cellpadding="10" cellspacing="0">
        <tr bgcolor="#FFFFFF" align="left" valign="top"> 
          <td>
		    <p align="center"><b>Rate this tip:</b></p>
		  <form name="form1" method="post" action="showcode.php">
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
                    <div align="center">
                      <table width="100%" border="0">
            <tr>
              <td width="36%">
                            <div align="right">poor</div>
              </td>
              <td width="250">
                            <div align="center">
                              <input type="radio" name="skill" value="1" class="borderless">
                              <input type="radio" name="skill" value="2" class="borderless">
                              <input type="radio" name="skill" value="3" class="borderless">
                              <input type="radio" name="skill" value="4" class="borderless">
                              <input type="radio" name="skill" value="5" class="borderless">
                            </div>
              </td>
                          <td>very good</td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <p align="center"> 
    <input type="hidden" name="id" value="2335">
    <input type="submit" name="Abschicken" value="Rate" class="button">
</form>
		  </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<br><br>

<table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
  <tr align="left" valign="top"> 
    <td height="3"> 
      <table width="100%" border="0" cellpadding="10" cellspacing="0">
        <tr bgcolor="#FFFFFF" align="left" valign="top"> 
          <td bgcolor="#99CCFF"> 
            <p><b>Sponsored Links</b></p>
            </td>
        </tr>
        <tr bgcolor="#FFFFFF" align="left" valign="top"> 
          <td>
<b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=97&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fwww.deskmarker.com%2Fen%2Findex.php&amp;ismap=' >Desk Marker</a></b><br>
Desk Marker allows to draw on windows with different pensize and color. The visual controls mode allows to mark visual controls like buttons and forms. With the transparency option you can colorize the visual controls. In the freehand mode the pen marker follows your mouse.<div id="beacon_97" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=97&amp;clientid=112&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=fd2bfda6fc6af8e5a4af071b809fe6db' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br><b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=85&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fwww.eurekalog.com%2Fbannerclick.php%3Fid%3D7&amp;ismap=' >Delphi Access Violations?</a></b><br>Catch every run-time Exception logging Unit, Class, Method, Line #.<br>
See an online demo now!<div id="beacon_85" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=85&amp;clientid=98&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=f01d84db28aa54bdd0202e92b0e8b40e' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br><b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=90&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fdedipower.com%2Fr.php%3Fid%3D6E98&amp;ismap=' >DediPower - The Leading Dedicated Server Provider!</a></b><br>Dedicated Servers from only £40 per month. Windows and Linux servers.<div id="beacon_90" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=90&amp;clientid=104&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=6a9debf591c974d303f2fc32aa6988ad' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br><b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=155&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fwww.tsilang.com%3Ftrack%3Dswiss_dc&amp;ismap=' >TsiLang Component Suite - the complete automatic internationalization
solution</a></b><br>
Localizing software for different international markets can double and even
quadruple sales. This is why almost every software company considers
localization a must. Yet, localization is both a complicated and expensive
process. Luckily for Delphi, C++Builder, and Kylix developers, there is
TsiLang Component Suite - the complete automatic localization solution.<div id="beacon_155" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=155&amp;clientid=187&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=fefd9f622ae0f716476a152434241521' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br><b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=101&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fwww.atozedsoftware.com&amp;ismap=' >Automate your Build Process with FinalBuilder</a></b><br>FinalBuilder is the tool for automating software builds. Automate compilers,
install builders, version control, automated testing tools, ftp client and
much more. Turn your build process into a one click operation, start to
finish! Add some quality to your development process with a reliable and
repeatable build process.<div id="beacon_101" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=101&amp;clientid=116&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=a27a8e1507a1799b7fc75d0a654de320' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br>			  
           </td>
        </tr>
				<td bgcolor="#FFFFFF">
				<div align="right"><a href="werbung.php">Advertise on SwissDelphiCenter</a></div>
      </table>
    </td>
  </tr>
</table>
<br>
        
        
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr> 
    <td> 
      <div align="center"><img src="../pics/linebottom.gif" width="214" height="1"><br>
        Copyright &copy; by SwissDelphiCenter.ch<br>
        All trademarks are the sole property of their respective owners </div>
    </td>
  </tr>
</table>
