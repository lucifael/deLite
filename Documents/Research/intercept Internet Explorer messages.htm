<HTML><HEAD><TITLE>SwissDelphiCenter.ch : ...intercept Internet Explorer messages?</TITLE></HEAD><META NAME="Title" CONTENT="SwissDelphiCenter.ch">
<META NAME="Author" CONTENT="Simon Grossenbacher"
<META NAME="Publisher" CONTENT="SwissDelphiCenter.ch">
<META NAME="Revisit" CONTENT="After 30 days">
<META NAME="Keywords" 
CONTENT="delphi,borland,programm,programming,schweiz,forum,forums,newsletter,download,delphi,kylix,linux,windows,winapi,libc, api">
<META NAME="Description" CONTENT="All about Borland Delphi. Programming tips, downloads, forums, news, topsites, newsletter">
<META NAME="Abstract" CONTENT="All about Borland Delphi.">
<META NAME="Robots" CONTENT="INDEX,FOLLOW">
<META NAME="expires" CONTENT="0">
<link rel="SHORTCUT ICON" href="http://www.swissdelphicenter.ch/favicon.ico">

<link rel="STYLESHEET" href="../swissdelphicenter.css" type="text/css">
</head>
<body bgcolor="#FFFFFF">
<table width="100%" border="0">
  <tr>
    <td width="33%"><i><a href="index.php"><img src="../pics/sdclogo.png" border="0" width="300" height="40"></a></i></td>
    <td width="67%">
<a href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=153&amp;zoneid=7&amp;source=&amp;dest=http%3A%2F%2Fwww.tsilang.com%3Ftrack%3Dswiss_dc' target='_blank'><img src='http://www.swissdelphicenter.com/ads/banners/bestglobalizationtool.gif' width='468' height='60' alt='' title='' border='0'></a><div id="beacon_153" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=153&amp;clientid=186&amp;zoneid=7&amp;source=&amp;block=0&amp;capping=0&amp;cb=451d2e3de6c97faa3c2cd6b246bdd625' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br>

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="werbung.php">Advertising on SwissDelphiCenter</a>

</td>
  </tr>
</table>
<br>
&nbsp;<a href="whatsnew.php">whats new</a>&nbsp;&brvbar;&nbsp;
<a href="tipsindex.php">programming tips</a>&nbsp;&brvbar;&nbsp;
<a href="indyarticles.php">indy articles</a>&nbsp;&brvbar;&nbsp;
<a href="iwarticles.php">intraweb articles</a>&nbsp;&brvbar;&nbsp;
<a href="infoindex.php">informations</a>&nbsp;&brvbar;&nbsp;
<a href="linksindex.php">links</a>&nbsp;&brvbar;&nbsp;
<a href="interviews.php">interviews</a>&nbsp;&brvbar;&nbsp;
<a href="sonstigesindex.php">misc</a>&nbsp;&brvbar;&nbsp;
<a href="forum/index.php">forum</a>
<br>
&nbsp;<a href="devnews.php">developer news</a>&nbsp;&brvbar;&nbsp;
<a href="kylix.php">kylix</a>&nbsp;&brvbar;&nbsp;
<a href="tutorials.php">tutorials</a>&nbsp;&brvbar;&nbsp;
<a href="shop.php">online shop</a>&nbsp;&brvbar;&nbsp;
<a href="photos/index.php">photos</a>&nbsp;&brvbar;&nbsp;
<a href="addwin.php">Add&Win Game</a>
<br><br>
<table width="100%" border="0" cellpadding="4" cellspacing="0">
  <tr>
    <td>
    </td>
  </tr>
  <tr> 
    <td>
      <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr> 
          <td width="21%" align="left" valign="top"> 
            <table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
              <tr align="left" valign="top"> 
                <td> 
                  <table width="100%" border="0" cellpadding="10" cellspacing="0">
                    <tr bgcolor="#99CCFF"> 
                      <td>
 
<p><b>Tips (1553)</b></p>

<a href="datenbanken.php">Database (90)</a><br><a href="dateien.php">Files (139)</a><br><a href="oberflaeche.php">Forms (112)</a><br><a href="grafik.php">Graphic (116)</a><br><a href="ide.php">IDE (21)</a><br><a href="indy.php">Indy (5)</a><br><a href="internet.php">Internet / LAN (130)</a><br><a href="intraweb.php">IntraWeb (0)</a><br><a href="kylixtips.php">Kylix (10)</a><br><a href="math.php">Math (77)</a><br><a href="sonstiges.php">Misc (126)</a><br><a href="multimedia.php">Multimedia (46)</a><br><a href="objekte.php">Objects/<br>ActiveX (51)</a><br><a href="opentools.php">OpenTools API (3)</a><br><a href="printing.php">Printing (34)</a><br><a href="strings.php">Strings (83)</a><br><a href="system.php">System (267)</a><br><a href="vcl.php">VCL (243)</a><br>


  <br>
  <a href="tiptop15.php">Top15</a><br><br>
  <a href="tipsbycomp.php">Tips sort by<br>component</a><br><br>
  <a href="tipsuchen.php">Search Tip</a><br><br>

  <a href="addtip.php">Add new Tip</a><br><br>
  <a href="addwin.php"><b>Add&Win Game</b></a>

</td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
            <br>
                    <table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
          <tr align="left" valign="top">
            <td height="3">
              <table width="100%" border="0" cellpadding="10" cellspacing="0" height="100%">
                <tr bgcolor="#FFFFFF" align="left" valign="top"> 
                  <td bgcolor="#99CCFF"><b>BorCon 2003 pictures</b></td>
                </tr>
                <tr bgcolor="#FFFFFF" align="left" valign="top">
                  
          <td>The Borland Conference 2003 has finished. We have taken some impressions for you in the <b><a 
href="http://www.swissdelphicenter.ch/en/photos/index.php">photo gallery</a></b></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
            <br>            
            <table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
              <tr align="left" valign="top"> 
                <td> 
                  <table width="100%" border="0" cellpadding="10" cellspacing="0">
                    <tr bgcolor="#99CCFF" align="left" valign="top"> 
                      <td>
                        <center>
<span class="useronline">112 Visitors Online</span>                        </center>
                        </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
            <br><br>
            <center>
            <a href="http://www.borland.com" target="_blank"><img src="../pics/btp.gif" alt="SwissDelphiCenter is a Borland Technology Partner" border="0"></a>
            </center>
          </td>
          <td width="1%" align="left" valign="top">&nbsp;</td>
          <td align="left" valign="top" width="78%"> 
            <table width="100%" border="0" cellpadding="2" cellspacing="0" height="100%" bgcolor="#0099FF">
              <tr> 
                <td> 
                  <table width="100%" border="0" cellpadding="5" height="100%" bgcolor="#FFFFFF" cellspacing="0">
                    <tr align="left" valign="top"> 
                      <td> 

<table width="100%" border="0">
  <tr> 
    <td>
      <span class="titel">...intercept Internet Explorer messages?</span>
    </td>
  </tr>
  <tr> 
    <td>Autor: 
      rllibby    </td>
  </tr>
  <tr><td>Homepage: <a href="http://www.experts-exchange.com/Programming/Programming_Languages/Delphi/Q_20850691.html" target="_blank">http://www.experts-exchange.com/Programming/Programming_Languages/Delphi/Q_20850691.html</a></td></tr><tr><td><a href="showcomment.php?id=2058">1 Comment(s) to this tip</a> [<a href="newcomment.php?id=2058">Write new comment</a>]</td></tr><tr><td>[ <a href="printcode.php?id=2058" target="_blank">Print tip</a> 
]</td><td>&nbsp;</td><td>&nbsp;</td></tr></table><br><blockquote><a href='demodownload.php?id=2058'><img src='../pics/demo-download.gif' border='0'></a></blockquote>
<br>
<table border="0" width="529">
  <tr> 
    <td width="149"><b>Tip Rating (24):</b></td>
    <td width="370">&nbsp;</td>
  </tr>
  <tr>
    <td>
<img src='../pics/progressbar-grau.gif'>&nbsp;<img src='../pics/progressbar-grau.gif'>&nbsp;<img src='../pics/progressbar-grau.gif'>&nbsp;<img src='../pics/progressbar-grau.gif'>&nbsp;<img src='../pics/progressbar-blau.gif'>&nbsp;</td>
  </tr>
</table>

<p><br>
</p>
<p>
<span class="sourcecode">
<font size=2 face="Courier New"><font color="#000080"><i>{<br />
This&nbsp;component&nbsp;allows&nbsp;you&nbsp;to&nbsp;intercept&nbsp;Internet&nbsp;Explorer&nbsp;messages&nbsp;such&nbsp;as<br />
&quot;StatusTextChangeEvent&quot;,&nbsp;&quot;DocumentCompleteEvent&quot;&nbsp;and&nbsp;so&nbsp;on.<br />
<br />
Mit&nbsp;folgende&nbsp;Komponente&nbsp;lassen&nbsp;sich&nbsp;Nachrichten&nbsp;wie<br />
&quot;StatusTextChangeEvent&quot;,&nbsp;&quot;DocumentCompleteEvent&quot;&nbsp;usw.&nbsp;von<br />
Internet&nbsp;Explorer&nbsp;Fenstern&nbsp;abfangen.<br />
}<br />
<br />
//----&nbsp;Component&nbsp;Source:&nbsp;Install&nbsp;this&nbsp;component&nbsp;first.<br />
<br />
</i></font><b>unit&nbsp;</b>IEEvents;<br />
<br />
<b>interface<br />
<br />
uses<br />
&nbsp;&nbsp;</b>Windows,&nbsp;SysUtils,&nbsp;Classes,&nbsp;Graphics,&nbsp;ComObj,&nbsp;ActiveX,&nbsp;SHDocVW;<br />
<br />
<b>type<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Event&nbsp;types&nbsp;exposed&nbsp;from&nbsp;the&nbsp;Internet&nbsp;Explorer&nbsp;interface<br />
&nbsp;&nbsp;</i></font>TIEStatusTextChangeEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;<b>const&nbsp;</b>Text:&nbsp;WideString)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEProgressChangeEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;Progress:&nbsp;Integer;&nbsp;ProgressMax:&nbsp;Integer)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIECommandStateChangeEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;Command:&nbsp;Integer;&nbsp;Enable:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEDownloadBeginEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEDownloadCompleteEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIETitleChangeEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;<b>const&nbsp;</b>Text:&nbsp;WideString)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEPropertyChangeEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;<b>const&nbsp;</b>szProperty:&nbsp;WideString)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEBeforeNavigate2Event&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>Flags:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>TargetFrameName:&nbsp;OleVariant;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>var&nbsp;</b>PostData:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>Headers:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>Cancel:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIENewWindow2Event&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;<b>var&nbsp;</b>ppDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>Cancel:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIENavigateComplete2Event&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEDocumentCompleteEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEOnQuitEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEOnVisibleEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;Visible:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEOnToolBarEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;ToolBar:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEOnMenuBarEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;MenuBar:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEOnStatusBarEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;StatusBar:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEOnFullScreenEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;FullScreen:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
&nbsp;&nbsp;TIEOnTheaterModeEvent&nbsp;=&nbsp;<b>procedure</b>(Sender:&nbsp;TObject;&nbsp;TheaterMode:&nbsp;WordBool)&nbsp;<b>of&nbsp;object</b>;<br />
<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Event&nbsp;component&nbsp;for&nbsp;Internet&nbsp;Explorer<br />
&nbsp;&nbsp;</i></font>TIEEvents&nbsp;=&nbsp;<b>class</b>(TComponent,&nbsp;IUnknown,&nbsp;IDispatch)<br />
&nbsp;&nbsp;<b>private<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Private&nbsp;declarations<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>FConnected:&nbsp;Boolean;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FCookie:&nbsp;Integer;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FCP:&nbsp;IConnectionPoint;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FSinkIID:&nbsp;TGuid;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FSource:&nbsp;IWebBrowser2;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FStatusTextChange:&nbsp;TIEStatusTextChangeEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FProgressChange:&nbsp;TIEProgressChangeEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FCommandStateChange:&nbsp;TIECommandStateChangeEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FDownloadBegin:&nbsp;TIEDownloadBeginEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FDownloadComplete:&nbsp;TIEDownloadCompleteEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FTitleChange:&nbsp;TIETitleChangeEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FPropertyChange:&nbsp;TIEPropertyChangeEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FBeforeNavigate2:&nbsp;TIEBeforeNavigate2Event;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FNewWindow2:&nbsp;TIENewWindow2Event;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FNavigateComplete2:&nbsp;TIENavigateComplete2Event;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FDocumentComplete:&nbsp;TIEDocumentCompleteEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOnQuit:&nbsp;TIEOnQuitEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOnVisible:&nbsp;TIEOnVisibleEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOnToolBar:&nbsp;TIEOnToolBarEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOnMenuBar:&nbsp;TIEOnMenuBarEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOnStatusBar:&nbsp;TIEOnStatusBarEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOnFullScreen:&nbsp;TIEOnFullScreenEvent;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOnTheaterMode:&nbsp;TIEOnTheaterModeEvent;<br />
&nbsp;&nbsp;<b>protected<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Protected&nbsp;declaratios&nbsp;for&nbsp;IUnknown<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>function&nbsp;</b>QueryInterface(<b>const&nbsp;</b>IID:&nbsp;TGUID;&nbsp;<b>out&nbsp;</b>Obj):&nbsp;HResult;&nbsp;<b>override</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>function&nbsp;</b>_AddRef:&nbsp;Integer;&nbsp;<b>stdcall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>function&nbsp;</b>_Release:&nbsp;Integer;&nbsp;<b>stdcall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Protected&nbsp;declaratios&nbsp;for&nbsp;IDispatch<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>function&nbsp;</b>GetIDsOfNames(<b>const&nbsp;</b>IID:&nbsp;TGUID;&nbsp;Names:&nbsp;Pointer;&nbsp;NameCount,&nbsp;LocaleID:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer;&nbsp;DispIDs:&nbsp;Pointer):&nbsp;HResult;&nbsp;<b>virtual</b>;&nbsp;<b>stdcall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>function&nbsp;</b>GetTypeInfo(Index,&nbsp;LocaleID:&nbsp;Integer;&nbsp;<b>out&nbsp;</b>TypeInfo):&nbsp;HResult;&nbsp;<b>virtual</b>;&nbsp;<b>stdcall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>function&nbsp;</b>GetTypeInfoCount(<b>out&nbsp;</b>Count:&nbsp;Integer):&nbsp;HResult;&nbsp;<b>virtual</b>;&nbsp;<b>stdcall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>function&nbsp;</b>Invoke(<b>DispID</b>:&nbsp;Integer;&nbsp;<b>const&nbsp;</b>IID:&nbsp;TGUID;&nbsp;LocaleID:&nbsp;Integer;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flags:&nbsp;Word;&nbsp;<b>var&nbsp;</b>Params;&nbsp;VarResult,&nbsp;ExcepInfo,&nbsp;ArgErr:&nbsp;Pointer):&nbsp;HResult;&nbsp;<b>virtual</b>;&nbsp;<b>stdcall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Protected&nbsp;declarations<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>procedure&nbsp;</b>DoStatusTextChange(<b>const&nbsp;</b>Text:&nbsp;WideString);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoProgressChange(Progress:&nbsp;Integer;&nbsp;ProgressMax:&nbsp;Integer);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoCommandStateChange(Command:&nbsp;Integer;&nbsp;Enable:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoDownloadBegin;&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoDownloadComplete;&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoTitleChange(<b>const&nbsp;</b>Text:&nbsp;WideString);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoPropertyChange(<b>const&nbsp;</b>szProperty:&nbsp;WideString);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoBeforeNavigate2(<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>var&nbsp;</b>Flags:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>TargetFrameName:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>PostData:&nbsp;OleVariant;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>var&nbsp;</b>Headers:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>Cancel:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoNewWindow2(<b>var&nbsp;</b>ppDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>Cancel:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoNavigateComplete2(<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoDocumentComplete(<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoOnQuit;&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoOnVisible(Visible:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoOnToolBar(ToolBar:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoOnMenuBar(MenuBar:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoOnStatusBar(StatusBar:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoOnFullScreen(FullScreen:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>DoOnTheaterMode(TheaterMode:&nbsp;WordBool);&nbsp;<b>safecall</b>;<br />
&nbsp;&nbsp;<b>public<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Public&nbsp;declarations<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>constructor&nbsp;</b>Create(AOwner:&nbsp;TComponent);&nbsp;<b>override</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>destructor&nbsp;</b>Destroy;&nbsp;<b>override</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>ConnectTo(Source:&nbsp;IWebBrowser2);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>Disconnect;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>SinkIID:&nbsp;TGuid&nbsp;<b>read&nbsp;</b>FSinkIID;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>Source:&nbsp;IWebBrowser2&nbsp;<b>read&nbsp;</b>FSource;<br />
&nbsp;&nbsp;<b>published<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Published&nbsp;declarations<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>property&nbsp;</b>WebObj:&nbsp;IWebBrowser2&nbsp;<b>read&nbsp;</b>FSource;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>Connected:&nbsp;Boolean&nbsp;<b>read&nbsp;</b>FConnected;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>StatusTextChange:&nbsp;TIEStatusTextChangeEvent&nbsp;<b>read&nbsp;</b>FStatusTextChange&nbsp;<b>write&nbsp;</b>FStatusTextChange;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>ProgressChange:&nbsp;TIEProgressChangeEvent&nbsp;<b>read&nbsp;</b>FProgressChange&nbsp;<b>write&nbsp;</b>FProgressChange;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>CommandStateChange:&nbsp;TIECommandStateChangeEvent&nbsp;<b>read&nbsp;</b>FCommandStateChange&nbsp;<b>write&nbsp;</b>FCommandStateChange;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>DownloadBegin:&nbsp;TIEDownloadBeginEvent&nbsp;<b>read&nbsp;</b>FDownloadBegin&nbsp;<b>write&nbsp;</b>FDownloadBegin;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>DownloadComplete:&nbsp;TIEDownloadCompleteEvent&nbsp;<b>read&nbsp;</b>FDownloadComplete&nbsp;<b>write&nbsp;</b>FDownloadComplete;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>TitleChange:&nbsp;TIETitleChangeEvent&nbsp;<b>read&nbsp;</b>FTitleChange&nbsp;<b>write&nbsp;</b>FTitleChange;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>PropertyChange:&nbsp;TIEPropertyChangeEvent&nbsp;<b>read&nbsp;</b>FPropertyChange&nbsp;<b>write&nbsp;</b>FPropertyChange;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>BeforeNavigate2:&nbsp;TIEBeforeNavigate2Event&nbsp;<b>read&nbsp;</b>FBeforeNavigate2&nbsp;<b>write&nbsp;</b>FBeforeNavigate2;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>NewWindow2:&nbsp;TIENewWindow2Event&nbsp;<b>read&nbsp;</b>FNewWindow2&nbsp;<b>write&nbsp;</b>FNewWindow2;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>NavigateComplete2:&nbsp;TIENavigateComplete2Event&nbsp;<b>read&nbsp;</b>FNavigateComplete2&nbsp;<b>write&nbsp;</b>FNavigateComplete2;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>DocumentComplete:&nbsp;TIEDocumentCompleteEvent&nbsp;<b>read&nbsp;</b>FDocumentComplete&nbsp;<b>write&nbsp;</b>FDocumentComplete;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>OnQuit:&nbsp;TIEOnQuitEvent&nbsp;<b>read&nbsp;</b>FOnQuit&nbsp;<b>write&nbsp;</b>FOnQuit;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>OnVisible:&nbsp;TIEOnVisibleEvent&nbsp;<b>read&nbsp;</b>FOnVisible&nbsp;<b>write&nbsp;</b>FOnVisible;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>OnToolBar:&nbsp;TIEOnToolBarEvent&nbsp;<b>read&nbsp;</b>FOnToolBar&nbsp;<b>write&nbsp;</b>FOnToolBar;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>OnMenuBar:&nbsp;TIEOnMenuBarEvent&nbsp;<b>read&nbsp;</b>FOnMenuBar&nbsp;<b>write&nbsp;</b>FOnMenuBar;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>OnStatusBar:&nbsp;TIEOnStatusBarEvent&nbsp;<b>read&nbsp;</b>FOnStatusBar&nbsp;<b>write&nbsp;</b>FOnStatusBar;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>OnFullScreen:&nbsp;TIEOnFullScreenEvent&nbsp;<b>read&nbsp;</b>FOnFullScreen&nbsp;<b>write&nbsp;</b>FOnFullScreen;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>property&nbsp;</b>OnTheaterMode:&nbsp;TIEOnTheaterModeEvent&nbsp;<b>read&nbsp;</b>FOnTheaterMode&nbsp;<b>write&nbsp;</b>FOnTheaterMode;<br />
&nbsp;&nbsp;<b>end</b>;<br />
<br />
<font color="#000080"><i>//&nbsp;Register&nbsp;procedure<br />
</i></font><b>procedure&nbsp;Register</b>;<br />
<br />
<b>implementation<br />
<br />
function&nbsp;</b>TIEEvents._AddRef:&nbsp;Integer;<br />
<b>begin<br />
<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;No&nbsp;more&nbsp;than&nbsp;2&nbsp;counts<br />
&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;2;<br />
<br />
<b>end</b>;<br />
<br />
<b>function&nbsp;</b>TIEEvents._Release:&nbsp;Integer;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Always&nbsp;maintain&nbsp;1&nbsp;ref&nbsp;count&nbsp;(component&nbsp;holds&nbsp;the&nbsp;ref&nbsp;count)<br />
&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;1;<br />
<b>end</b>;<br />
<br />
<b>function&nbsp;</b>TIEEvents.QueryInterface(<b>const&nbsp;</b>IID:&nbsp;TGUID;&nbsp;<b>out&nbsp;</b>Obj):&nbsp;HResult;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Clear&nbsp;interface&nbsp;pointer<br />
&nbsp;&nbsp;</i></font>Pointer(Obj)&nbsp;:=&nbsp;<b>nil</b>;<br />
<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Attempt&nbsp;to&nbsp;get&nbsp;the&nbsp;requested&nbsp;interface<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>(GetInterface(IID,&nbsp;Obj))&nbsp;<b>then<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Success<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;S_OK<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Check&nbsp;to&nbsp;see&nbsp;if&nbsp;the&nbsp;guid&nbsp;requested&nbsp;is&nbsp;for&nbsp;the&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>else&nbsp;if&nbsp;</b>(IsEqualIID(IID,&nbsp;FSinkIID))&nbsp;<b>then<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Event&nbsp;is&nbsp;dispatch&nbsp;based,&nbsp;so&nbsp;get&nbsp;dispatch&nbsp;interface&nbsp;(closest&nbsp;we&nbsp;can&nbsp;come)<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>if&nbsp;</b>(GetInterface(IDispatch,&nbsp;Obj))&nbsp;<b>then<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Success<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;S_OK<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Failure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;E_NOINTERFACE;<br />
&nbsp;&nbsp;<b>end<br />
&nbsp;&nbsp;else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Failure<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;E_NOINTERFACE;<br />
<b>end</b>;<br />
<br />
<b>function&nbsp;</b>TIEEvents.GetIDsOfNames(<b>const&nbsp;</b>IID:&nbsp;TGUID;&nbsp;Names:&nbsp;Pointer;&nbsp;NameCount,<br />
&nbsp;&nbsp;LocaleID:&nbsp;Integer;&nbsp;DispIDs:&nbsp;Pointer):&nbsp;HResult;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Not&nbsp;implemented<br />
&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;E_NOTIMPL;<br />
<b>end</b>;<br />
<br />
<b>function&nbsp;</b>TIEEvents.GetTypeInfo(Index,&nbsp;LocaleID:&nbsp;Integer;&nbsp;<b>out&nbsp;</b>TypeInfo):&nbsp;HResult;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Clear&nbsp;the&nbsp;result&nbsp;interface<br />
&nbsp;&nbsp;</i></font>Pointer(TypeInfo)&nbsp;:=&nbsp;<b>nil</b>;<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;No&nbsp;type&nbsp;info&nbsp;for&nbsp;our&nbsp;interface<br />
&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;E_NOTIMPL;<br />
<b>end</b>;<br />
<br />
<b>function&nbsp;</b>TIEEvents.GetTypeInfoCount(<b>out&nbsp;</b>Count:&nbsp;Integer):&nbsp;HResult;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Zero&nbsp;type&nbsp;info&nbsp;counts<br />
&nbsp;&nbsp;</i></font>Count&nbsp;:=&nbsp;0;<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Return&nbsp;success<br />
&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;S_OK;<br />
<b>end</b>;<br />
<br />
<b>function&nbsp;</b>TIEEvents.Invoke(<b>DispID</b>:&nbsp;Integer;&nbsp;<b>const&nbsp;</b>IID:&nbsp;TGUID;&nbsp;LocaleID:&nbsp;Integer;&nbsp;Flags:&nbsp;Word;<br />
&nbsp;&nbsp;<b>var&nbsp;</b>Params;&nbsp;VarResult,&nbsp;ExcepInfo,&nbsp;ArgErr:&nbsp;Pointer):&nbsp;HResult;<br />
<b>var&nbsp;</b>pdpParams:&nbsp;PDispParams;<br />
&nbsp;&nbsp;lpDispIDs:&nbsp;<b>array</b>[0..63]&nbsp;<b>of&nbsp;</b>TDispID;<br />
&nbsp;&nbsp;dwCount:&nbsp;Integer;<br />
<b>begin<br />
<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Get&nbsp;the&nbsp;parameters<br />
&nbsp;&nbsp;</i></font>pdpParams&nbsp;:=&nbsp;@Params;<br />
<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Events&nbsp;can&nbsp;only&nbsp;be&nbsp;called&nbsp;with&nbsp;method&nbsp;dispatch,&nbsp;not&nbsp;property&nbsp;get/set<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>((Flags&nbsp;<b>and&nbsp;</b>DISPATCH_METHOD)&nbsp;&gt;&nbsp;0)&nbsp;<b>then<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Clear&nbsp;DispID&nbsp;list<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>ZeroMemory(@lpDispIDs,&nbsp;SizeOf(lpDispIDs));<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Build&nbsp;dispatch&nbsp;ID&nbsp;list&nbsp;to&nbsp;handle&nbsp;named&nbsp;args<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>if&nbsp;</b>(pdpParams^.cArgs&nbsp;&gt;&nbsp;0)&nbsp;<b>then<br />
&nbsp;&nbsp;&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Reverse&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;params&nbsp;because&nbsp;they&nbsp;are&nbsp;backwards<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>for&nbsp;</b>dwCount&nbsp;:=&nbsp;0&nbsp;<b>to&nbsp;</b>Pred(pdpParams^.cArgs)&nbsp;<b>do&nbsp;</b>lpDispIDs[dwCount]&nbsp;:=&nbsp;Pred(pdpParams^.cArgs)&nbsp;-&nbsp;dwCount;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Handle&nbsp;named&nbsp;arguments<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>if&nbsp;</b>(pdpParams^.cNamedArgs&nbsp;&gt;&nbsp;0)&nbsp;<b>then<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</b>dwCount&nbsp;:=&nbsp;0&nbsp;<b>to&nbsp;</b>Pred(pdpParams^.cNamedArgs)&nbsp;<b>do<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>lpDispIDs[pdpParams^.rgdispidNamedArgs^[dwCount]]&nbsp;:=&nbsp;dwCount;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Unless&nbsp;the&nbsp;event&nbsp;falls&nbsp;into&nbsp;the&nbsp;&quot;else&quot;&nbsp;clause&nbsp;of&nbsp;the&nbsp;case&nbsp;statement&nbsp;the&nbsp;result&nbsp;is&nbsp;S_OK<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;S_OK;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Handle&nbsp;the&nbsp;event<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>case&nbsp;DispID&nbsp;of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>102:&nbsp;DoStatusTextChange(pdpParams^.rgvarg^[lpDispIds[0]].bstrval);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;104:&nbsp;DoDownloadComplete;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;105:&nbsp;DoCommandStateChange(pdpParams^.rgvarg^[lpDispIds[0]].lval,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdpParams^.rgvarg^[lpDispIds[1]].vbool);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;106:&nbsp;DoDownloadBegin;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;108:&nbsp;DoProgressChange(pdpParams^.rgvarg^[lpDispIds[0]].lval,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdpParams^.rgvarg^[lpDispIds[1]].lval);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;112:&nbsp;DoPropertyChange(pdpParams^.rgvarg^[lpDispIds[0]].bstrval);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;113:&nbsp;DoTitleChange(pdpParams^.rgvarg^[lpDispIds[0]].bstrval);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;250:&nbsp;DoBeforeNavigate2(IDispatch(pdpParams^.rgvarg^[lpDispIds[0]].dispval),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POleVariant(pdpParams^.rgvarg^[lpDispIds[1]].pvarval)^,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POleVariant(pdpParams^.rgvarg^[lpDispIds[2]].pvarval)^,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POleVariant(pdpParams^.rgvarg^[lpDispIds[3]].pvarval)^,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POleVariant(pdpParams^.rgvarg^[lpDispIds[4]].pvarval)^,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POleVariant(pdpParams^.rgvarg^[lpDispIds[5]].pvarval)^,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdpParams^.rgvarg^[lpDispIds[6]].pbool^);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;251:&nbsp;DoNewWindow2(IDispatch(pdpParams^.rgvarg^[lpDispIds[0]].pdispval^),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdpParams^.rgvarg^[lpDispIds[1]].pbool^);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;252:&nbsp;DoNavigateComplete2(IDispatch(pdpParams^.rgvarg^[lpDispIds[0]].dispval),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POleVariant(pdpParams^.rgvarg^[lpDispIds[1]].pvarval)^);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;253:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Special&nbsp;case&nbsp;handler.&nbsp;When&nbsp;Quit&nbsp;is&nbsp;called,&nbsp;IE&nbsp;is&nbsp;going&nbsp;away&nbsp;so&nbsp;we&nbsp;might<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;as&nbsp;well&nbsp;unbind&nbsp;from&nbsp;the&nbsp;interface&nbsp;by&nbsp;calling&nbsp;disconnect.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font>DoOnQuit;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;&nbsp;Call&nbsp;disconnect<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font>Disconnect;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;254:&nbsp;DoOnVisible(pdpParams^.rgvarg^[lpDispIds[0]].vbool);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255:&nbsp;DoOnToolBar(pdpParams^.rgvarg^[lpDispIds[0]].vbool);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;256:&nbsp;DoOnMenuBar(pdpParams^.rgvarg^[lpDispIds[0]].vbool);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;257:&nbsp;DoOnStatusBar(pdpParams^.rgvarg^[lpDispIds[0]].vbool);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;258:&nbsp;DoOnFullScreen(pdpParams^.rgvarg^[lpDispIds[0]].vbool);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;259:&nbsp;DoDocumentComplete(IDispatch(pdpParams^.rgvarg^[lpDispIds[0]].dispval),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POleVariant(pdpParams^.rgvarg^[lpDispIds[1]].pvarval)^);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;260:&nbsp;DoOnTheaterMode(pdpParams^.rgvarg^[lpDispIds[0]].vbool);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Have&nbsp;to&nbsp;idea&nbsp;of&nbsp;what&nbsp;event&nbsp;they&nbsp;are&nbsp;calling<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;DISP_E_MEMBERNOTFOUND;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;<b>end<br />
&nbsp;&nbsp;else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Called&nbsp;with&nbsp;wrong&nbsp;flags<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>result&nbsp;:=&nbsp;DISP_E_MEMBERNOTFOUND;<br />
<b>end</b>;<br />
<br />
<b>constructor&nbsp;</b>TIEEvents.Create(AOwner:&nbsp;TComponent);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Perform&nbsp;inherited<br />
&nbsp;&nbsp;</i></font><b>inherited&nbsp;</b>Create(AOwner);<br />
<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Set&nbsp;the&nbsp;event&nbsp;sink&nbsp;IID<br />
&nbsp;&nbsp;</i></font>FSinkIID&nbsp;:=&nbsp;DWebBrowserEvents2;<br />
<b>end</b>;<br />
<br />
<b>destructor&nbsp;</b>TIEEvents.Destroy;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Disconnect<br />
&nbsp;&nbsp;</i></font>Disconnect;<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Perform&nbsp;inherited<br />
&nbsp;&nbsp;</i></font><b>inherited&nbsp;</b>Destroy;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.ConnectTo(Source:&nbsp;IWebBrowser2);<br />
<b>var&nbsp;</b>pvCPC:&nbsp;IConnectionPointContainer;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Disconnect&nbsp;from&nbsp;any&nbsp;currently&nbsp;connected&nbsp;event&nbsp;sink<br />
&nbsp;&nbsp;</i></font>Disconnect;<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Query&nbsp;for&nbsp;the&nbsp;connection&nbsp;point&nbsp;container&nbsp;and&nbsp;desired&nbsp;connection&nbsp;point.<br />
&nbsp;&nbsp;//&nbsp;On&nbsp;success,&nbsp;sink&nbsp;the&nbsp;connection&nbsp;point<br />
&nbsp;&nbsp;</i></font>OleCheck(Source.QueryInterface(IConnectionPointContainer,&nbsp;pvCPC));<br />
&nbsp;&nbsp;OleCheck(pvCPC.FindConnectionPoint(FSinkIID,&nbsp;FCP));<br />
&nbsp;&nbsp;OleCheck(FCP.Advise(Self,&nbsp;FCookie));<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Update&nbsp;internal&nbsp;state&nbsp;variables<br />
&nbsp;&nbsp;</i></font>FSource&nbsp;:=&nbsp;Source;<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;We&nbsp;are&nbsp;in&nbsp;a&nbsp;connected&nbsp;state<br />
&nbsp;&nbsp;</i></font>FConnected&nbsp;:=&nbsp;True;<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Release&nbsp;the&nbsp;temp&nbsp;interface<br />
&nbsp;&nbsp;</i></font>pvCPC&nbsp;:=&nbsp;<b>nil</b>;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.Disconnect;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Do&nbsp;we&nbsp;have&nbsp;the&nbsp;IWebBrowser2&nbsp;interface?<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FSource)&nbsp;<b>then<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;try<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Unadvise&nbsp;the&nbsp;connection&nbsp;point<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font>OleCheck(FCP.Unadvise(FCookie));<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Release&nbsp;the&nbsp;interfaces<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font>FCP&nbsp;:=&nbsp;<b>nil</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FSource&nbsp;:=&nbsp;<b>nil</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>except<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>Pointer(FCP)&nbsp;:=&nbsp;<b>nil</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pointer(FSource)&nbsp;:=&nbsp;<b>nil</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;<b>end</b>;<br />
<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Disconnected&nbsp;state<br />
&nbsp;&nbsp;</i></font>FConnected&nbsp;:=&nbsp;False;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoStatusTextChange(<b>const&nbsp;</b>Text:&nbsp;WideString);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FStatusTextChange)&nbsp;<b>then&nbsp;</b>FStatusTextChange(Self,&nbsp;Text);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoProgressChange(Progress:&nbsp;Integer;&nbsp;ProgressMax:&nbsp;Integer);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FProgressChange)&nbsp;<b>then&nbsp;</b>FProgressChange(Self,&nbsp;Progress,&nbsp;ProgressMax);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoCommandStateChange(Command:&nbsp;Integer;&nbsp;Enable:&nbsp;WordBool);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FCommandStateChange)&nbsp;<b>then&nbsp;</b>FCommandStateChange(Self,&nbsp;Command,&nbsp;Enable);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoDownloadBegin;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FDownloadBegin)&nbsp;<b>then&nbsp;</b>FDownloadBegin(Self);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoDownloadComplete;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FDownloadComplete)&nbsp;<b>then&nbsp;</b>FDownloadComplete(Self);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoTitleChange(<b>const&nbsp;</b>Text:&nbsp;WideString);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FTitleChange)&nbsp;<b>then&nbsp;</b>FTitleChange(Self,&nbsp;Text);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoPropertyChange(<b>const&nbsp;</b>szProperty:&nbsp;WideString);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FPropertyChange)&nbsp;<b>then&nbsp;</b>FPropertyChange(Self,&nbsp;szProperty);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoBeforeNavigate2(<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>Flags:<br />
&nbsp;&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>TargetFrameName:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>PostData:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>Headers:&nbsp;OleVariant;&nbsp;<b>var&nbsp;</b>Cancel:&nbsp;WordBool);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FBeforeNavigate2)&nbsp;<b>then&nbsp;</b>FBeforeNavigate2(Self,&nbsp;pDisp,&nbsp;URL,&nbsp;Flags,&nbsp;TargetFrameName,&nbsp;PostData,&nbsp;Headers,&nbsp;Cancel);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoNewWindow2(<b>var&nbsp;</b>ppDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>Cancel:&nbsp;WordBool);<br />
<b>var<br />
&nbsp;&nbsp;</b>pvDisp:&nbsp;IDispatch;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FNewWindow2)&nbsp;<b>then<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</b>Assigned(ppDisp)&nbsp;<b>then<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>pvDisp&nbsp;:=&nbsp;ppDisp<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>pvDisp&nbsp;:=&nbsp;<b>nil</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;FNewWindow2(Self,&nbsp;pvDisp,&nbsp;Cancel);<br />
&nbsp;&nbsp;&nbsp;&nbsp;ppDisp&nbsp;:=&nbsp;pvDisp;<br />
&nbsp;&nbsp;<b>end</b>;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoNavigateComplete2(<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FNavigateComplete2)&nbsp;<b>then&nbsp;</b>FNavigateComplete2(Self,&nbsp;pDisp,&nbsp;URL);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoDocumentComplete(<b>const&nbsp;</b>pDisp:&nbsp;IDispatch;&nbsp;<b>var&nbsp;</b>URL:&nbsp;OleVariant);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FDocumentComplete)&nbsp;<b>then&nbsp;</b>FDocumentComplete(Self,&nbsp;pDisp,&nbsp;URL);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoOnQuit;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FOnQuit)&nbsp;<b>then&nbsp;</b>FOnQuit(Self);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoOnVisible(Visible:&nbsp;WordBool);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FOnVisible)&nbsp;<b>then&nbsp;</b>FOnVisible(Self,&nbsp;Visible);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoOnToolBar(ToolBar:&nbsp;WordBool);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FOnToolBar)&nbsp;<b>then&nbsp;</b>FOnToolBar(Self,&nbsp;ToolBar);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoOnMenuBar(MenuBar:&nbsp;WordBool);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FOnMenuBar)&nbsp;<b>then&nbsp;</b>FOnMenuBar(Self,&nbsp;MenuBar);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoOnStatusBar(StatusBar:&nbsp;WordBool);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FOnStatusBar)&nbsp;<b>then&nbsp;</b>FOnStatusBar(Self,&nbsp;StatusBar);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoOnFullScreen(FullScreen:&nbsp;WordBool);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FOnFullScreen)&nbsp;<b>then&nbsp;</b>FOnFullScreen(Self,&nbsp;FullScreen);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TIEEvents.DoOnTheaterMode(TheaterMode:&nbsp;WordBool);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Call&nbsp;assigned&nbsp;event<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>Assigned(FOnTheaterMode)&nbsp;<b>then&nbsp;</b>FOnTheaterMode(Self,&nbsp;TheaterMode);<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;Register</b>;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Register&nbsp;the&nbsp;component&nbsp;on&nbsp;the&nbsp;Internet&nbsp;tab&nbsp;of&nbsp;the&nbsp;IDE<br />
&nbsp;&nbsp;</i></font>RegisterComponents('Internet',&nbsp;[TIEEvents]);<br />
<b>end</b>;<br />
<br />
<b>end</b>.<br />
<br />
<br />
---&nbsp;Project&nbsp;source&nbsp;----<br />
<font color="#000080"><i>//Notes:&nbsp;Add&nbsp;a&nbsp;button&nbsp;and&nbsp;the&nbsp;IEEvents&nbsp;component&nbsp;to&nbsp;Form1.&nbsp;The&nbsp;button1&nbsp;click&nbsp;event<br />
//&nbsp;shows&nbsp;&nbsp;how&nbsp;the&nbsp;IE&nbsp;enumeration&nbsp;is&nbsp;achieved,&nbsp;and&nbsp;shows&nbsp;how&nbsp;the&nbsp;binding&nbsp;is&nbsp;done:<br />
<br />
</i></font><b>unit&nbsp;</b>Unit1;<br />
<br />
<b>interface<br />
<br />
uses<br />
&nbsp;&nbsp;</b>Windows,&nbsp;Messages,&nbsp;SysUtils,&nbsp;Variants,&nbsp;Classes,&nbsp;Graphics,&nbsp;Controls,&nbsp;Forms,<br />
&nbsp;&nbsp;Dialogs,&nbsp;IEEvents,&nbsp;StdCtrls,&nbsp;ActiveX,&nbsp;SHDocVw;<br />
<br />
<b>type<br />
&nbsp;&nbsp;</b>TForm1&nbsp;=&nbsp;<b>class</b>(TForm)<br />
&nbsp;&nbsp;&nbsp;&nbsp;IEEvents1:&nbsp;TIEEvents;<br />
&nbsp;&nbsp;&nbsp;&nbsp;Button1:&nbsp;TButton;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>FormCreate(Sender:&nbsp;TObject);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>FormDestroy(Sender:&nbsp;TObject);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>IEEvents1Quit(Sender:&nbsp;TObject);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>IEEvents1DownloadBegin(Sender:&nbsp;TObject);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>IEEvents1DownloadComplete(Sender:&nbsp;TObject);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>Button1Click(Sender:&nbsp;TObject);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>procedure&nbsp;</b>IEEvents1ProgressChange(Sender:&nbsp;TObject;&nbsp;Progress,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProgressMax:&nbsp;Integer);<br />
&nbsp;&nbsp;<b>private<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>{&nbsp;Private&nbsp;declarations&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>FTimeList:&nbsp;TList;<br />
&nbsp;&nbsp;<b>public<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>{&nbsp;Public&nbsp;declarations&nbsp;}<br />
&nbsp;&nbsp;</i></font><b>end</b>;<br />
<br />
<b>var<br />
&nbsp;&nbsp;</b>Form1:&nbsp;TForm1;<br />
<br />
<b>implementation<br />
<br />
</b><font color="#000080"><i>{$R&nbsp;*.dfm}<br />
<br />
</i></font><b>procedure&nbsp;</b>TForm1.Button1Click(Sender:&nbsp;TObject);<br />
<b>var<br />
&nbsp;&nbsp;</b>pvShell:&nbsp;IShellWindows;<br />
&nbsp;&nbsp;pvWeb2:&nbsp;IWebBrowser2;<br />
&nbsp;&nbsp;ovIE:&nbsp;OleVariant;<br />
&nbsp;&nbsp;dwCount:&nbsp;Integer;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Create&nbsp;the&nbsp;shell&nbsp;windows&nbsp;interface<br />
&nbsp;&nbsp;</i></font>pvShell&nbsp;:=&nbsp;CoShellWindows.Create;<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Walk&nbsp;the&nbsp;internet&nbsp;explorer&nbsp;windows<br />
&nbsp;&nbsp;</i></font><b>for&nbsp;</b>dwCount&nbsp;:=&nbsp;0&nbsp;<b>to&nbsp;</b>Pred(pvShell.Count)&nbsp;<b>do<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Get&nbsp;the&nbsp;interface<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>ovIE&nbsp;:=&nbsp;pvShell.Item(dwCount);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;At&nbsp;this&nbsp;point&nbsp;you&nbsp;can&nbsp;evaluate&nbsp;the&nbsp;interface&nbsp;(LocationUrl,&nbsp;etc)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;to&nbsp;decide&nbsp;if&nbsp;this&nbsp;is&nbsp;the&nbsp;one&nbsp;you&nbsp;want&nbsp;to&nbsp;connect&nbsp;to.&nbsp;For&nbsp;demo&nbsp;purposes,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;code&nbsp;will&nbsp;bind&nbsp;to&nbsp;the&nbsp;first&nbsp;one<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>ShowMessage(ovIE.LocationURL);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;QI&nbsp;for&nbsp;the&nbsp;IWebBrowser2<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>if&nbsp;</b>(IDispatch(ovIE).QueryInterface(IWebBrowser2,&nbsp;pvWeb2)&nbsp;=&nbsp;S_OK)&nbsp;<b>then<br />
&nbsp;&nbsp;&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>IEEvents1.ConnectTo(pvWeb2);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Release&nbsp;the&nbsp;interface<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i></font>pvWeb2&nbsp;:=&nbsp;<b>nil</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Clear&nbsp;the&nbsp;variant<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>ovIE&nbsp;:=&nbsp;Unassigned;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Break&nbsp;if&nbsp;we&nbsp;connected<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font><b>if&nbsp;</b>IEEvents1.Connected&nbsp;<b>then&nbsp;</b>break;<br />
&nbsp;&nbsp;<b>end</b>;<br />
&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Release&nbsp;the&nbsp;shell&nbsp;windows&nbsp;interface<br />
&nbsp;&nbsp;</i></font>pvShell&nbsp;:=&nbsp;<b>nil</b>;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TForm1.FormCreate(Sender:&nbsp;TObject);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Create&nbsp;the&nbsp;time&nbsp;list<br />
&nbsp;&nbsp;</i></font>FTimeList&nbsp;:=&nbsp;TList.Create;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TForm1.FormDestroy(Sender:&nbsp;TObject);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Free&nbsp;the&nbsp;time&nbsp;list<br />
&nbsp;&nbsp;</i></font>FTimeList.Free;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TForm1.IEEvents1DownloadBegin(Sender:&nbsp;TObject);<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Add&nbsp;the&nbsp;current&nbsp;time&nbsp;to&nbsp;the&nbsp;list<br />
&nbsp;&nbsp;</i></font>FTimeList.Add(Pointer(GetTickCount));<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TForm1.IEEvents1DownloadComplete(Sender:&nbsp;TObject);<br />
<b>var&nbsp;</b>dwTime:&nbsp;LongWord;<br />
<b>begin<br />
&nbsp;&nbsp;</b><font color="#000080"><i>//&nbsp;Pull&nbsp;the&nbsp;top&nbsp;item&nbsp;off&nbsp;the&nbsp;list&nbsp;(make&nbsp;sure&nbsp;there&nbsp;is&nbsp;one)<br />
&nbsp;&nbsp;</i></font><b>if&nbsp;</b>(FTimeList.Count&nbsp;&gt;&nbsp;0)&nbsp;<b>then<br />
&nbsp;&nbsp;begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b>dwTime&nbsp;:=&nbsp;LongWord(FTimeList[Pred(FTimeList.Count)]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;FTimeList.Delete(Pred(FTimeList.Count));<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Now&nbsp;calculate&nbsp;total&nbsp;based&nbsp;on&nbsp;current&nbsp;time<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>dwTime&nbsp;:=&nbsp;GetTickCount&nbsp;-&nbsp;dwTime;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><i>//&nbsp;Display&nbsp;a&nbsp;message&nbsp;showing&nbsp;total&nbsp;download&nbsp;time<br />
&nbsp;&nbsp;&nbsp;&nbsp;</i></font>ShowMessage(Format('Download&nbsp;time&nbsp;for&nbsp;&quot;%s&quot;&nbsp;was&nbsp;%d&nbsp;ms',&nbsp;[IEEvents1.WebObj.LocationURL,&nbsp;dwTime]));<br />
&nbsp;&nbsp;<b>end</b>;<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TForm1.IEEvents1Quit(Sender:&nbsp;TObject);<br />
<b>begin<br />
&nbsp;&nbsp;</b>ShowMessage('About&nbsp;to&nbsp;disconnect');<br />
<b>end</b>;<br />
<br />
<b>procedure&nbsp;</b>TForm1.IEEvents1ProgressChange(Sender:&nbsp;TObject;&nbsp;Progress,<br />
&nbsp;&nbsp;ProgressMax:&nbsp;Integer);<br />
<b>begin<br />
&nbsp;&nbsp;</b>Caption&nbsp;:=&nbsp;IntToStr(Progress);<br />
<b>end</b>;<br />
<br />
<b>end</b>.<br />
<br />
</font></font></span>
<br>
</p>
<p>&nbsp;</p>
<table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
  <tr align="left" valign="top"> 
    <td height="3"> 
      <table width="100%" border="0" cellpadding="10" cellspacing="0">
        <tr bgcolor="#FFFFFF" align="left" valign="top"> 
          <td>
		    <p align="center"><b>Rate this tip:</b></p>
		  <form name="form1" method="post" action="showcode.php">
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
                    <div align="center">
                      <table width="100%" border="0">
            <tr>
              <td width="36%">
                            <div align="right">poor</div>
              </td>
              <td width="250">
                            <div align="center">
                              <input type="radio" name="skill" value="1" class="borderless">
                              <input type="radio" name="skill" value="2" class="borderless">
                              <input type="radio" name="skill" value="3" class="borderless">
                              <input type="radio" name="skill" value="4" class="borderless">
                              <input type="radio" name="skill" value="5" class="borderless">
                            </div>
              </td>
                          <td>very good</td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  <p align="center"> 
    <input type="hidden" name="id" value="2058">
    <input type="submit" name="Abschicken" value="Rate" class="button">
</form>
		  </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<br><br>

<table border="0" bgcolor="#0099FF" cellpadding="2" cellspacing="0" width="100%">
  <tr align="left" valign="top"> 
    <td height="3"> 
      <table width="100%" border="0" cellpadding="10" cellspacing="0">
        <tr bgcolor="#FFFFFF" align="left" valign="top"> 
          <td bgcolor="#99CCFF"> 
            <p><b>Sponsored Links</b></p>
            </td>
        </tr>
        <tr bgcolor="#FFFFFF" align="left" valign="top"> 
          <td>
<b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=101&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fwww.atozedsoftware.com&amp;ismap=' >Automate your Build Process with FinalBuilder</a></b><br>FinalBuilder is the tool for automating software builds. Automate compilers,
install builders, version control, automated testing tools, ftp client and
much more. Turn your build process into a one click operation, start to
finish! Add some quality to your development process with a reliable and
repeatable build process.<div id="beacon_101" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=101&amp;clientid=116&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=5a660eddae936fafb4e8a2d94317cdd8' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br><b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=155&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fwww.tsilang.com%3Ftrack%3Dswiss_dc&amp;ismap=' >TsiLang Component Suite - the complete automatic internationalization
solution</a></b><br>
Localizing software for different international markets can double and even
quadruple sales. This is why almost every software company considers
localization a must. Yet, localization is both a complicated and expensive
process. Luckily for Delphi, C++Builder, and Kylix developers, there is
TsiLang Component Suite - the complete automatic localization solution.<div id="beacon_155" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=155&amp;clientid=187&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=4b3b553c0b199fa60cd6e959f9b933a1' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br><b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=97&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fwww.deskmarker.com%2Fen%2Findex.php&amp;ismap=' >Desk Marker</a></b><br>
Desk Marker allows to draw on windows with different pensize and color. The visual controls mode allows to mark visual controls like buttons and forms. With the transparency option you can colorize the visual controls. In the freehand mode the pen marker follows your mouse.<div id="beacon_97" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=97&amp;clientid=112&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=f00fcc5237b7ee6c8dc779e78b10277c' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br><b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=90&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fdedipower.com%2Fr.php%3Fid%3D6E98&amp;ismap=' >DediPower - The Leading Dedicated Server Provider!</a></b><br>Dedicated Servers from only 40 per month. Windows and Linux servers.<div id="beacon_90" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=90&amp;clientid=104&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=553cc2ccbf0ac19706e2c7f1f3e26b1a' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br><b><a target='_blank' href='http://www.swissdelphicenter.ch/ads/adclick.php?bannerid=85&amp;zoneid=11&amp;source=&amp;dest=http%3A%2F%2Fwww.eurekalog.com%2Fbannerclick.php%3Fid%3D7&amp;ismap=' >Delphi Access Violations?</a></b><br>Catch every run-time Exception logging Unit, Class, Method, Line #.<br>
See an online demo now!<div id="beacon_85" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src='http://www.swissdelphicenter.ch/ads/adlog.php?bannerid=85&amp;clientid=98&amp;zoneid=11&amp;source=&amp;block=0&amp;capping=0&amp;cb=3d3ab9894e276bf5a7a2ec79112f58e3' width='0' height='0' alt='' style='width: 0px; height: 0px;'></div><br><br>			  
           </td>
        </tr>
				<td bgcolor="#FFFFFF">
				<div align="right"><a href="werbung.php">Advertise on SwissDelphiCenter</a></div>
      </table>
    </td>
  </tr>
</table>
<br>
        
        
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr> 
    <td> 
      <div align="center"><img src="../pics/linebottom.gif" width="214" height="1"><br>
        Copyright &copy; by SwissDelphiCenter.ch<br>
        All trademarks are the sole property of their respective owners </div>
    </td>
  </tr>
</table>
